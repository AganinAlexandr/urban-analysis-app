#!/usr/bin/env python3
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–ª—è–º–∏
"""

import requests
import json
import time

def demo_field_fixes():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ–±–ª–µ–º —Å –ø–æ–ª—è–º–∏"""
    
    print("üéØ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô –ü–†–û–ë–õ–ï–ú –° –ü–û–õ–Ø–ú–ò")
    print("=" * 60)
    print()
    print("üîß –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:")
    print("1. ‚úÖ –ü–æ–ª—è latitude, longitude, district —Ç–µ–ø–µ—Ä—å –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ")
    print("2. ‚úÖ –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª—è 'stars' -> 'rating' –∏—Å–ø—Ä–∞–≤–ª–µ–Ω")
    print("3. ‚úÖ –†–∞—Å—á–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –ø–æ–ª—è")
    print("4. ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ø–æ–ª–µ–π")
    print()
    
    try:
        # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞—Ä—Ö–∏–≤–µ
        response = requests.get('http://localhost:5000/archive/info')
        
        if response.status_code == 200:
            data = response.json()
            
            print("üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ê–†–•–ò–í–ê:")
            print(f"   –í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: {data['total_records']}")
            print(f"   –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø: {len(data['groups'])}")
            print()
            
            print("üìà –ó–ê–ü–û–õ–ù–ï–ù–ù–û–°–¢–¨ –ü–û–õ–ï–ô (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø):")
            field_names = {
                'review_text': '–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞',
                'rating': '–†–µ–π—Ç–∏–Ω–≥',
                'answer_text': '–û—Ç–≤–µ—Ç',
                'latitude_auto': '–®–∏—Ä–æ—Ç–∞ (–∞–≤—Ç–æ)',
                'longitude_auto': '–î–æ–ª–≥–æ—Ç–∞ (–∞–≤—Ç–æ)',
                'district_auto': '–†–∞–π–æ–Ω (–∞–≤—Ç–æ)'
            }
            
            for field, percentage in data['field_completeness'].items():
                display_name = field_names.get(field, field)
                if percentage >= 80:
                    status = "üü¢ –û—Ç–ª–∏—á–Ω–æ"
                elif percentage >= 50:
                    status = "üü° –•–æ—Ä–æ—à–æ"
                else:
                    status = "üî¥ –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è"
                
                print(f"   {display_name}: {percentage}% {status}")
            
            print()
            print("üé® –û–°–û–ë–ï–ù–ù–û–°–¢–ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:")
            print("   ‚Ä¢ –ü–æ–ª—è —Å –ø–æ–º–µ—Ç–∫–æ–π '(–∞–≤—Ç–æ)' –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏")
            print("   ‚Ä¢ –ò—Ö –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏, –∞ –Ω–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
            print("   ‚Ä¢ –ü–æ–ª–µ '–†–µ–π—Ç–∏–Ω–≥' —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∞–ø–∏—Ç—Å—è —Å –ø–æ–ª—è 'stars' –≤ JSON")
            print("   ‚Ä¢ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö")
            print()
            print("üåê –î–õ–Ø –ü–†–û–°–ú–û–¢–†–ê:")
            print("   1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä")
            print("   2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://localhost:5000")
            print("   3. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞—Ä—Ö–∏–≤–µ'")
            print("   4. –£–≤–∏–¥–∏—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –¥–∏–∞–≥—Ä–∞–º–º—É —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –ø–æ–ª–µ–π")
            print()
            print("‚úÖ –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!")
            
            return True
        else:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö: HTTP {response.status_code}")
            return False
            
    except requests.exceptions.ConnectionError:
        print("‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É")
        print("   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ: python app.py")
        return False
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return False

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è"""
    
    print("–ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π...")
    print("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ http://localhost:5000")
    print()
    
    time.sleep(1)
    
    if demo_field_fixes():
        print("\nüéâ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!")
        return True
    else:
        print("\nüí• –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å!")
        return False

if __name__ == "__main__":
    main() 